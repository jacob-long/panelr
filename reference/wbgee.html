<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Fit "within-between" and several other regression variants
for panel data via generalized estimating equations.'><title>Panel regression models fit with GEE — wbgee • panelr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Lato-0.4.6/font.css" rel="stylesheet"><link href="../deps/IBM_Plex_Mono-0.4.6/font.css" rel="stylesheet"><link href="../deps/Raleway-0.4.6/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Panel regression models fit with GEE — wbgee"><meta property="og:description" content='Fit "within-between" and several other regression variants
for panel data via generalized estimating equations.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">panelr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/wbm.html">
    <span class="fa fa-book"></span>
     
    Package Introduction
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/reshape.html">
    <span class="fa fa-arrows"></span>
     
    Reshaping Tutorial
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Documentation
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jacob-long/panelr">
    <span class="fa fa-github fa-lg"></span>
     
    Github
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Panel regression models fit with GEE</h1>
      <small class="dont-index">Source: <a href="https://github.com/jacob-long/panelr/blob/HEAD/R/wb_gee.R" class="external-link"><code>R/wb_gee.R</code></a></small>
      <div class="d-none name"><code>wbgee.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit "within-between" and several other regression variants
for panel data via generalized estimating equations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wbgee</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wave <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"w-b"</span>,</span>
<span>  cor.str <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ar1"</span>, <span class="st">"exchangeable"</span>, <span class="st">"unstructured"</span><span class="op">)</span>,</span>
<span>  detrend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use.wave <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wave.factor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min.waves <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span>,</span>
<span>  balance.correction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dt.random <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dt.order <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  interaction.style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"double-demean"</span>, <span class="st">"demean"</span>, <span class="st">"raw"</span><span class="op">)</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale.response <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n.sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  calc.fit.stats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Model formula. See details for crucial
info on <code>panelr</code>'s formula syntax.</p></dd>


<dt>data</dt>
<dd><p>The data, either a <code>panel_data</code> object or <code>data.frame</code>.</p></dd>


<dt>id</dt>
<dd><p>If <code>data</code> is not a <code>panel_data</code> object, then the name of the
individual id column as a string. Otherwise, leave as NULL, the default.</p></dd>


<dt>wave</dt>
<dd><p>If <code>data</code> is not a <code>panel_data</code> object, then the name of the
panel wave column as a string. Otherwise, leave as NULL, the default.</p></dd>


<dt>model</dt>
<dd><p>One of <code>"w-b"</code>, <code>"within"</code>, <code>"between"</code>,
<code>"contextual"</code>. See details for more on these options.</p></dd>


<dt>cor.str</dt>
<dd><p>Any correlation structure accepted by <code><a href="https://rdrr.io/pkg/geepack/man/geeglm.html" class="external-link">geepack::geeglm()</a></code>.
Default is "ar1", most useful alternative is "exchangeable". "unstructured"
may cause problems due to its computational complexity.</p></dd>


<dt>detrend</dt>
<dd><p>Adjust within-subject effects for trends in the predictors?
Default is FALSE, but some research suggests this is a better idea
(see Curran and Bauer (2011) reference).</p></dd>


<dt>use.wave</dt>
<dd><p>Should the wave be included as a predictor? Default is
FALSE.</p></dd>


<dt>wave.factor</dt>
<dd><p>Should the wave variable be treated as an unordered
factor instead of continuous? Default is FALSE.</p></dd>


<dt>min.waves</dt>
<dd><p>What is the minimum number of waves an individual must
have participated in to be included in the analysis? Default is <code>2</code> and
any valid number is accepted. <code>"all"</code> is also acceptable if you want to
include only complete panelists.</p></dd>


<dt>family</dt>
<dd><p>Use this to specify GLM link families. Default is <code>gaussian</code>,
the linear model.</p></dd>


<dt>balance.correction</dt>
<dd><p>Correct between-subject effects for unbalanced
panels following the procedure in Curran and Bauer (2011)? Default is
FALSE.</p></dd>


<dt>dt.random</dt>
<dd><p>Should the detrending procedure be performed with a
random slope for each entity? Default is TRUE but for short panels
FALSE may be better, fitting a trend for all entities.</p></dd>


<dt>dt.order</dt>
<dd><p>If detrending using <code>detrend</code>, what order polynomial
would you like to specify for the relationship between time and the
predictors? Default is 1, a linear model.</p></dd>


<dt>weights</dt>
<dd><p>If using weights, either the name of the column in the data
that contains the weights or a vector of the weights.</p></dd>


<dt>offset</dt>
<dd><p>this can be used to specify an <em>a priori</em> known
    component to be included in the linear predictor during
    fitting. This should be <code>NULL</code> or a numeric vector of length
    equal to the number of cases.  One or more <code><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></code>
    terms can be included in the formula instead or as well, and if more
    than one is specified their sum is used.  See <code><a href="https://rdrr.io/r/stats/model.extract.html" class="external-link">model.offset</a></code>.</p></dd>


<dt>interaction.style</dt>
<dd><p>The best way to calculate interactions in within
models is in some dispute. The conventional way (<code>"demean"</code>) is to first
calculate the product of the variables involved in the interaction before
those variables have their means subtracted and then subtract the mean of
the product from the product term (see Schunk and Perales (2017)).
Giesselmann and Schmidt-Catran (2020) show this method carries
between-entity differences that within models are designed to model out.
They suggest an alternate method (<code>"double-demean"</code>) in which the product
term is first calculated using the de-meaned lower-order variables and
then the subject means are subtracted from this product term. Another
option is to simply use the product term of the de-meaned variables
(<code>"raw"</code>), but Giesselmann and Schmidt-Catran (2020) show this method
biases the results towards zero effect. The default is <code>"double-demean"</code>
but if emulating other software is the goal, <code>"demean"</code> might be
preferred.</p></dd>


<dt>scale</dt>
<dd><p>If <code>TRUE</code>, reports standardized regression
coefficients by scaling and mean-centering input data (the latter can be
changed via the <code>scale.only</code> argument). Default is <code>FALSE</code>.</p></dd>


<dt>scale.response</dt>
<dd><p>Should the response variable also be rescaled? Default
is <code>FALSE</code>.</p></dd>


<dt>n.sd</dt>
<dd><p>How many standard deviations should you divide by for
standardization? Default is 1, though some prefer 2.</p></dd>


<dt>calc.fit.stats</dt>
<dd><p>Calculate fit statistics? Default is TRUE, but
occasionally poor-fitting models might trip up here.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments provided to <code><a href="https://rdrr.io/pkg/geepack/man/geeglm.html" class="external-link">geepack::geeglm()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>wbgee</code> object, which inherits from <code>geeglm</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See the documentation for <code><a href="wbm.html">wbm()</a></code> for many details on formula syntax and
other arguments.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Allison, P. (2009). <em>Fixed effects regression models</em>.
Thousand Oaks, CA: SAGE Publications.
https://doi.org/10.4135/9781412993869.d33</p>
<p>Bell, A., &amp; Jones, K. (2015). Explaining fixed effects: Random effects
modeling of time-series cross-sectional and panel data.
<em>Political Science Research and Methods</em>, <em>3</em>, 133–153.
https://doi.org/10.1017/psrm.2014.7</p>
<p>Curran, P. J., &amp; Bauer, D. J. (2011). The disaggregation of within-person
and between-person effects in longitudinal models of change.
<em>Annual Review of Psychology</em>, <em>62</em>, 583–619.
https://doi.org/10.1146/annurev.psych.093008.100356</p>
<p>Giesselmann, M., &amp; Schmidt-Catran, A. W. (2020). Interactions in fixed
effects regression models. <em>Sociological Methods &amp; Research</em>, 1–28.
https://doi.org/10.1177/0049124120914934</p>
<p>McNeish, D. (2019). Effect partitioning in cross-sectionally clustered data
without multilevel models. <em>Multivariate Behavioral Research</em>,
Advance online publication. https://doi.org/10.1080/00273171.2019.1602504</p>
<p>McNeish, D., Stapleton, L. M., &amp; Silverman, R. D. (2016). On the unnecessary
ubiquity of hierarchical linear modeling. <em>Psychological Methods</em>, <em>22</em>,
114-140. https://doi.org/10.1037/met0000078</p>
<p>Schunck, R., &amp; Perales, F. (2017). Within- and between-cluster effects in
generalized linear mixed models: A discussion of approaches and the
<code>xthybrid</code> command. <em>The Stata Journal</em>, <em>17</em>, 89–115.
https://doi.org/10.1177/1536867X1701700106</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jacob A. Long</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"WageData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wages</span> <span class="op">&lt;-</span> <span class="fu"><a href="panel_data.html">panel_data</a></span><span class="op">(</span><span class="va">WageData</span>, id <span class="op">=</span> <span class="va">id</span>, wave <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">wbgee</span><span class="op">(</span><span class="va">lwage</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">union</span><span class="op">)</span> <span class="op">+</span> <span class="va">wks</span> <span class="op">|</span> <span class="va">blk</span> <span class="op">+</span> <span class="va">fem</span> <span class="op">|</span> <span class="va">blk</span> <span class="op">*</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">union</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         data <span class="op">=</span> <span class="va">wages</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">MODEL INFO:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Entities: </span>595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Time periods: </span>2-7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Dependent variable: </span>lwage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Model type:</span> Linear GEE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Variance: </span>ar1 (alpha = 0.85)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">Specification: </span>within-between</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">MODEL FIT:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-style: italic;">QIC = </span>655.54, <span style="font-style: italic;">QICu = </span>653.36, <span style="font-style: italic;">CIC = </span>9.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">WITHIN EFFECTS:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Est.   S.E.   z val.      p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------- ------- ------ -------- ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag(union)          0.02   0.02     0.98   0.33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wks                -0.00   0.00    -0.82   0.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">BETWEEN EFFECTS:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            Est.   S.E.   z val.      p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------- ------- ------ -------- ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                6.61   0.24    27.12   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> imean(lag(union))         -0.01   0.03    -0.40   0.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> imean(wks)                 0.00   0.01     0.75   0.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> blk                       -0.23   0.06    -3.86   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fem                       -0.43   0.05    -8.94   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">CROSS-LEVEL INTERACTIONS:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         Est.   S.E.   z val.      p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------- ------- ------ -------- ------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lag(union):blk         -0.11   0.05    -2.22   0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jacob A. Long.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

